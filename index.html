<html>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="jquery.js"></script>
<script src="http://d3js.org/topojson.v1.min.js"></script>
<script src="datamaps.world.min.js"></script>
<!--<script src="data.js"></script> -->

<div id="container" style="position: relative; width: 100%; height: 100%;"></div>
<script>
    var map = new Datamap({element: document.getElementById('container')});
    $(document).ready(function() {
	    $.get('imports.csv', function(data) {
	   		 console.log(processData(data));
	    }, 'text');
});



    function processData(allText) {
	    var record_num = 22;  // or however many elements there are in each row
	    var allTextLines = allText.split(/\r\n|\n/);
	    var entries = allTextLines[0].split(',');
	    var lines = [];

	    var headings = entries.splice(0,record_num);
	    while (entries.length>0) {
	        var tarr = [];
	        for (var j=0; j<record_num; j++) {
	            tarr.push(headings[j]+":"+entries.shift());
	        }
	        lines.push(tarr);
	    }
	    // alert(lines);
	    return lines;
	}



</script>
</html>